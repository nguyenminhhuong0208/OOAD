{"ast":null,"code":"const ASYMMETRIC_KEY_DETAILS_SUPPORTED = require('./asymmetricKeyDetailsSupported');\nconst RSA_PSS_KEY_DETAILS_SUPPORTED = require('./rsaPssKeyDetailsSupported');\nconst allowedAlgorithmsForKeys = {\n  'ec': ['ES256', 'ES384', 'ES512'],\n  'rsa': ['RS256', 'PS256', 'RS384', 'PS384', 'RS512', 'PS512'],\n  'rsa-pss': ['PS256', 'PS384', 'PS512']\n};\nconst allowedCurves = {\n  ES256: 'prime256v1',\n  ES384: 'secp384r1',\n  ES512: 'secp521r1'\n};\nmodule.exports = function (algorithm, key) {\n  if (!algorithm || !key) return;\n  const keyType = key.asymmetricKeyType;\n  if (!keyType) return;\n  const allowedAlgorithms = allowedAlgorithmsForKeys[keyType];\n  if (!allowedAlgorithms) {\n    throw new Error(`Unknown key type \"${keyType}\".`);\n  }\n  if (!allowedAlgorithms.includes(algorithm)) {\n    throw new Error(`\"alg\" parameter for \"${keyType}\" key type must be one of: ${allowedAlgorithms.join(', ')}.`);\n  }\n\n  /*\n   * Ignore the next block from test coverage because it gets executed\n   * conditionally depending on the Node version. Not ignoring it would\n   * prevent us from reaching the target % of coverage for versions of\n   * Node under 15.7.0.\n   */\n  /* istanbul ignore next */\n  if (ASYMMETRIC_KEY_DETAILS_SUPPORTED) {\n    switch (keyType) {\n      case 'ec':\n        const keyCurve = key.asymmetricKeyDetails.namedCurve;\n        const allowedCurve = allowedCurves[algorithm];\n        if (keyCurve !== allowedCurve) {\n          throw new Error(`\"alg\" parameter \"${algorithm}\" requires curve \"${allowedCurve}\".`);\n        }\n        break;\n      case 'rsa-pss':\n        if (RSA_PSS_KEY_DETAILS_SUPPORTED) {\n          const length = parseInt(algorithm.slice(-3), 10);\n          const {\n            hashAlgorithm,\n            mgf1HashAlgorithm,\n            saltLength\n          } = key.asymmetricKeyDetails;\n          if (hashAlgorithm !== `sha${length}` || mgf1HashAlgorithm !== hashAlgorithm) {\n            throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of \"alg\" ${algorithm}.`);\n          }\n          if (saltLength !== undefined && saltLength > length >> 3) {\n            throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of \"alg\" ${algorithm}.`);\n          }\n        }\n        break;\n    }\n  }\n};","map":{"version":3,"names":["ASYMMETRIC_KEY_DETAILS_SUPPORTED","require","RSA_PSS_KEY_DETAILS_SUPPORTED","allowedAlgorithmsForKeys","allowedCurves","ES256","ES384","ES512","module","exports","algorithm","key","keyType","asymmetricKeyType","allowedAlgorithms","Error","includes","join","keyCurve","asymmetricKeyDetails","namedCurve","allowedCurve","length","parseInt","slice","hashAlgorithm","mgf1HashAlgorithm","saltLength","undefined"],"sources":["C:/Users/Admin/Favorites/OOAD/fontend/node_modules/jsonwebtoken/lib/validateAsymmetricKey.js"],"sourcesContent":["const ASYMMETRIC_KEY_DETAILS_SUPPORTED = require('./asymmetricKeyDetailsSupported');\nconst RSA_PSS_KEY_DETAILS_SUPPORTED = require('./rsaPssKeyDetailsSupported');\n\nconst allowedAlgorithmsForKeys = {\n  'ec': ['ES256', 'ES384', 'ES512'],\n  'rsa': ['RS256', 'PS256', 'RS384', 'PS384', 'RS512', 'PS512'],\n  'rsa-pss': ['PS256', 'PS384', 'PS512']\n};\n\nconst allowedCurves = {\n  ES256: 'prime256v1',\n  ES384: 'secp384r1',\n  ES512: 'secp521r1',\n};\n\nmodule.exports = function(algorithm, key) {\n  if (!algorithm || !key) return;\n\n  const keyType = key.asymmetricKeyType;\n  if (!keyType) return;\n\n  const allowedAlgorithms = allowedAlgorithmsForKeys[keyType];\n\n  if (!allowedAlgorithms) {\n    throw new Error(`Unknown key type \"${keyType}\".`);\n  }\n\n  if (!allowedAlgorithms.includes(algorithm)) {\n    throw new Error(`\"alg\" parameter for \"${keyType}\" key type must be one of: ${allowedAlgorithms.join(', ')}.`)\n  }\n\n  /*\n   * Ignore the next block from test coverage because it gets executed\n   * conditionally depending on the Node version. Not ignoring it would\n   * prevent us from reaching the target % of coverage for versions of\n   * Node under 15.7.0.\n   */\n  /* istanbul ignore next */\n  if (ASYMMETRIC_KEY_DETAILS_SUPPORTED) {\n    switch (keyType) {\n    case 'ec':\n      const keyCurve = key.asymmetricKeyDetails.namedCurve;\n      const allowedCurve = allowedCurves[algorithm];\n\n      if (keyCurve !== allowedCurve) {\n        throw new Error(`\"alg\" parameter \"${algorithm}\" requires curve \"${allowedCurve}\".`);\n      }\n      break;\n\n    case 'rsa-pss':\n      if (RSA_PSS_KEY_DETAILS_SUPPORTED) {\n        const length = parseInt(algorithm.slice(-3), 10);\n        const { hashAlgorithm, mgf1HashAlgorithm, saltLength } = key.asymmetricKeyDetails;\n\n        if (hashAlgorithm !== `sha${length}` || mgf1HashAlgorithm !== hashAlgorithm) {\n          throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of \"alg\" ${algorithm}.`);\n        }\n\n        if (saltLength !== undefined && saltLength > length >> 3) {\n          throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of \"alg\" ${algorithm}.`)\n        }\n      }\n      break;\n    }\n  }\n}\n"],"mappings":"AAAA,MAAMA,gCAAgC,GAAGC,OAAO,CAAC,iCAAiC,CAAC;AACnF,MAAMC,6BAA6B,GAAGD,OAAO,CAAC,6BAA6B,CAAC;AAE5E,MAAME,wBAAwB,GAAG;EAC/B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;EACjC,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;EAC7D,SAAS,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO;AACvC,CAAC;AAED,MAAMC,aAAa,GAAG;EACpBC,KAAK,EAAE,YAAY;EACnBC,KAAK,EAAE,WAAW;EAClBC,KAAK,EAAE;AACT,CAAC;AAEDC,MAAM,CAACC,OAAO,GAAG,UAASC,SAAS,EAAEC,GAAG,EAAE;EACxC,IAAI,CAACD,SAAS,IAAI,CAACC,GAAG,EAAE;EAExB,MAAMC,OAAO,GAAGD,GAAG,CAACE,iBAAiB;EACrC,IAAI,CAACD,OAAO,EAAE;EAEd,MAAME,iBAAiB,GAAGX,wBAAwB,CAACS,OAAO,CAAC;EAE3D,IAAI,CAACE,iBAAiB,EAAE;IACtB,MAAM,IAAIC,KAAK,CAAE,qBAAoBH,OAAQ,IAAG,CAAC;EACnD;EAEA,IAAI,CAACE,iBAAiB,CAACE,QAAQ,CAACN,SAAS,CAAC,EAAE;IAC1C,MAAM,IAAIK,KAAK,CAAE,wBAAuBH,OAAQ,8BAA6BE,iBAAiB,CAACG,IAAI,CAAC,IAAI,CAAE,GAAE,CAAC;EAC/G;;EAEA;AACF;AACA;AACA;AACA;AACA;EACE;EACA,IAAIjB,gCAAgC,EAAE;IACpC,QAAQY,OAAO;MACf,KAAK,IAAI;QACP,MAAMM,QAAQ,GAAGP,GAAG,CAACQ,oBAAoB,CAACC,UAAU;QACpD,MAAMC,YAAY,GAAGjB,aAAa,CAACM,SAAS,CAAC;QAE7C,IAAIQ,QAAQ,KAAKG,YAAY,EAAE;UAC7B,MAAM,IAAIN,KAAK,CAAE,oBAAmBL,SAAU,qBAAoBW,YAAa,IAAG,CAAC;QACrF;QACA;MAEF,KAAK,SAAS;QACZ,IAAInB,6BAA6B,EAAE;UACjC,MAAMoB,MAAM,GAAGC,QAAQ,CAACb,SAAS,CAACc,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;UAChD,MAAM;YAAEC,aAAa;YAAEC,iBAAiB;YAAEC;UAAW,CAAC,GAAGhB,GAAG,CAACQ,oBAAoB;UAEjF,IAAIM,aAAa,KAAM,MAAKH,MAAO,EAAC,IAAII,iBAAiB,KAAKD,aAAa,EAAE;YAC3E,MAAM,IAAIV,KAAK,CAAE,gGAA+FL,SAAU,GAAE,CAAC;UAC/H;UAEA,IAAIiB,UAAU,KAAKC,SAAS,IAAID,UAAU,GAAGL,MAAM,IAAI,CAAC,EAAE;YACxD,MAAM,IAAIP,KAAK,CAAE,4GAA2GL,SAAU,GAAE,CAAC;UAC3I;QACF;QACA;IACF;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}